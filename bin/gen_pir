#!/bin/bash

app=$1
log=$2
pir_src_dir=$3

cd $SPATIAL_HOME
app_file=$pir_src_dir/$app.scala
pir_dir=$SPATIAL_HOME/gen/$app/pir
if [ -e $pir_dir ]; then rm -r $pir_dir; fi
if [ -e $app_file ]; then rm $app_file; fi
mkdir -p $SPATIAL_HOME/gen/$app
mkdir -p $pir_src_dir 
mkdir -p $pir_dir
$SPATIAL_HOME/bin/spatial $app --dot --cgra+ --pirsrc $pir_src_dir >> $log 2>&1

echo "-------------PASS (DONE)------------" >> $log
