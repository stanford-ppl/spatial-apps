#!/bin/bash

app=$1
net=$2
vlink=$3
slink=$4

outDir=$PIR_HOME/out/${app}_${net}_v${vlink}_s${slink}
psimOutDir=$PLASTISIM_HOME/configs/finals/${app}_${net}_v${vlink}_s${slink}
config=${outDir}/config.psim

[ -e $config ] && rm $config
export _JAVA_OPTIONS="-Xss8192k" 
$PIR_HOME/bin/pir $app \
  --out=$outDir \
  --psim-out=$psimOutDir \
  --debug=false \
  --verbose=true \
  --dot=false \
  --mapping=true \
  --load-pir=true \
  --save-pir=true \
  --psim=true \
  --trace=true \
  --ctrl=true \
  --bp=false \
  --stat=true \
  --net=$net \
  --routing-algo=proute \
  --proute-iter=1000 \
  --run-psim=true \
  --arch=MyDesign \
  --row=16 --col=8 \
  --topo=mesh \
  --argin=64 \
  --tokenout=32 \
  --fifo-depth=4 \
  --vfifo=4 \
  --vc=4 \
  --vlink=${vlink} \
  --slink=${slink}

echo "-------------PASS (DONE)------------"
